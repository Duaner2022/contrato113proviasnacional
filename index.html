<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control Ejecuci√≥n Contractual | Contrato 113</title>
<style>
    /* --- ESTILOS VISUALES --- */
    body { font-family: 'Segoe UI', Helvetica, Arial, sans-serif; background: #f0f2f5; margin: 0; padding-bottom: 80px; color: #333; }
    
    /* CABECERA */
    .header { background: #003366; color: white; padding: 25px 20px; border-bottom: 6px solid #002244; text-align: center; }
    .header-content { display: flex; flex-direction: column; align-items: center; gap: 20px; max-width: 1000px; margin: 0 auto; }
    
    /* T√çTULO */
    .title-area h1 { margin: 0; font-size: 2.2rem; letter-spacing: 1px; font-weight: 900; text-transform: uppercase; line-height: 1.1; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
    .title-area p { margin: 8px 0 0; font-size: 1.3rem; opacity: 1; font-weight: 600; color: #b3e5fc; letter-spacing: 0.5px; }

    /* RELOJ */
    .live-clock { text-align: center; background: rgba(0,0,0,0.25); padding: 15px 30px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.15); box-shadow: 0 4px 10px rgba(0,0,0,0.2); margin-top: 5px; }
    .clock-greeting { font-weight: 800; color: #ffeb3b; text-transform: uppercase; letter-spacing: 1px; font-size: 1.1rem; display: block; margin-bottom: 5px; }
    .clock-time { font-family: 'Courier New', monospace; font-weight: 900; font-size: 2.8rem; color: white; line-height: 1; display: block; margin: 5px 0; text-shadow: 0 0 10px rgba(0,255,255,0.5); }
    .clock-date { font-size: 1rem; color: #e0e0e0; font-weight: 500; text-transform: capitalize; }

    /* BOTONES */
    .btn-row { display: flex; justify-content: center; gap: 20px; margin-top: 25px; }
    .btn { padding: 12px 25px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; color: white; font-size: 1rem; display: inline-flex; align-items: center; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: transform 0.2s; }
    .btn:hover { transform: translateY(-2px); }
    .btn-ws { background: #25D366; }
    .btn-pdf { background: #fff; color: #003366; }

    /* CONTENEDOR */
    .container { max-width: 900px; margin: 30px auto; padding: 0 15px; }

    /* --- TABLA RESUMEN --- */
    .summary-box { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 40px; border: 1px solid #e1e4e8; }
    .summary-title { color: #003366; font-weight: 800; font-size: 1.1rem; margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; text-transform: uppercase; }
    
    .table-container { overflow-x: auto; }
    .resumen-table { width: 100%; border-collapse: collapse; min-width: 600px; font-size: 0.95rem; }
    .resumen-table th { background-color: #0288d1; color: white; padding: 12px; text-align: center; border: 1px solid #0277bd; font-weight: 700; font-size: 0.9rem; }
    .resumen-table td { padding: 10px; border: 1px solid #eee; text-align: center; vertical-align: middle; }
    .resumen-table tr:nth-child(even) { background-color: #f9f9f9; }
    
    .txt-left { text-align: left !important; }
    .txt-red { color: #d32f2f; font-weight: 700; }
    .txt-bold { font-weight: 900; color: #000; }

    /* TARJETAS DETALLE */
    .card { background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; overflow: hidden; border: 1px solid #e1e4e8; }
    .card-head { padding: 25px; cursor: pointer; position: relative; background: #fff; }
    .card-title { font-weight: 800; color: #003366; font-size: 1.3rem; margin-bottom: 10px; padding-right: 30px; }
    .toggle-icon { position: absolute; right: 25px; top: 25px; font-size: 1.3rem; color: #bbb; }

    .plazo-badge { display: inline-block; background-color: #e3f2fd; color: #0d47a1; font-size: 0.9rem; font-weight: bold; padding: 6px 14px; border-radius: 6px; margin-bottom: 20px; border: 1px solid #bbdefb; }

    /* STATS */
    .stats { display: flex; gap: 15px; background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #eee; }
    .stat-box { flex: 1; text-align: center; display: flex; flex-direction: column; justify-content: center; }
    .stat-lbl { font-size: 0.8rem; font-weight: 800; color: #444; text-transform: uppercase; min-height: 40px; display: flex; align-items: center; justify-content: center; line-height: 1.2; }
    .stat-val { font-size: 2.5rem; font-weight: 900; color: #333; margin: 10px 0; line-height: 1; }
    .stat-desc { font-size: 0.85rem; color: #666; margin-bottom: 8px; font-weight: 500; }
    .stat-date { font-size: 1.1rem; color: #003366; font-weight: 800; border-top: 2px solid #ddd; padding-top: 8px; margin-top: auto; }

    .s-ok { background: #e8f5e9; } .s-ok .stat-val { color: #2e7d32; }
    .s-warn { background: #fff8e1; } .s-warn .stat-val { color: #f57f17; }
    .s-dang { background: #ffebee; } .s-dang .stat-val { color: #c62828; }

    /* DETALLES */
    .card-body { display: none; padding: 25px; border-top: 1px solid #eee; background: #fff; }
    .card.open .card-body { display: block; }
    .card.open .toggle-icon { transform: rotate(180deg); }

    ul { padding-left: 0; margin: 0; list-style: none; }
    li { margin-bottom: 12px; line-height: 1.6; font-size: 1rem; position: relative; padding-left: 30px; text-align: justify; }
    li::before { content: "üîπ"; position: absolute; left: 0; top: 0; }
    .check::before { content: "‚úÖ"; }

    /* NOTAS */
    .notes { background: #e3f2fd; color: #0d47a1; padding: 25px; border-radius: 12px; border: 2px solid #90caf9; margin-top: 40px; font-size: 1rem; }
    .notes h4 { margin-top: 0; display: flex; align-items: center; gap: 10px; font-size: 1.2rem; color: #01579b; border-bottom: 1px solid #90caf9; padding-bottom: 10px; margin-bottom: 15px; }
    .notes li { margin-bottom: 10px; }
    .notes li::before { content: "‚úÖ"; font-size: 1rem; }

    /* ERROR */
    #error-display { color: red; text-align: center; padding: 20px; display: none; }

    /* PRINT */
    @media print {
        body { background: white; }
        .header { background: white; color: black; border-bottom: 2px solid black; padding: 10px; }
        .header-content { display: block; text-align: center; }
        .title-area h1 { font-size: 1.8rem; color: black; text-shadow: none; }
        .title-area p { color: black; }
        .live-clock, .btn-row, .toggle-icon, .stat-lbl { display: none; } 
        .card, .summary-box { box-shadow: none; border: 1px solid #000; break-inside: avoid; }
        .card-body { display: block !important; }
        .stats { background: white; border: none; padding: 0; margin-top: 5px; }
        .stat-box { border: 1px solid #ccc; padding: 5px; margin-right: 5px; }
        .plazo-badge { border: 1px solid #000; background: #eee; color: #000; }
        .resumen-table th { background-color: #ddd !important; color: black !important; border: 1px solid #000; }
        .resumen-table td { border: 1px solid #000; }
        a { text-decoration: none; color: black; pointer-events: none; }
    }
</style>
</head>
<body>

<div class="header">
    <div class="header-content">
        <div class="title-area">
            <h1>EJECUCION CONTRACTUAL - DIA 1 (16 DIC 2025)</h1>
            <p>Contrato N¬∞113-2025-MTC/20.2</p>
        </div>
        <div class="live-clock">
            <span class="clock-greeting">HOLA CONSORCIO HARZONE - KAYSUN</span>
            <div id="clock-display" class="clock-time">--:--:--</div>
            <div id="date-display" class="clock-date">...</div>
        </div>
    </div>
    
    <div class="btn-row">
        <button class="btn btn-ws" onclick="shareWS()">üí¨ WhatsApp Reporte</button>
        <button class="btn btn-pdf" onclick="window.print()">üñ®Ô∏è PDF / Imprimir</button>
    </div>
</div>

<div class="container">
    <div id="error-display"></div>

    <div class="summary-box">
        <h4 class="summary-title">üìä RESUMEN GENERAL DE OBLIGACIONES</h4>
        <div class="table-container">
            <table class="resumen-table">
                <thead>
                    <tr>
                        <th>√çtem</th>
                        <th>Obligaci√≥n Principal</th>
                        <th>Plazo (d√≠as calendario)</th>
                        <th>Planeamiento (30 d√≠as antes)</th>
                        <th>Fecha L√≠mite (Entrega)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td class="txt-left">Entrega de Documentaci√≥n T√©cnica</td>
                        <td>90 dc</td>
                        <td class="txt-red">13-Feb-2026</td>
                        <td class="txt-bold">15-Mar-2026</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td class="txt-left">1ra Entrega (Lote 1)</td>
                        <td>150 dc</td>
                        <td class="txt-red">14-Abr-2026</td>
                        <td class="txt-bold">14-May-2026</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td class="txt-left">2da Entrega (Lote 2)</td>
                        <td>200 dc</td>
                        <td class="txt-red">03-Jun-2026</td>
                        <td class="txt-bold">03-Jul-2026</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td class="txt-left">3era Entrega (Lote 3)</td>
                        <td>240 dc</td>
                        <td class="txt-red">13-Jul-2026</td>
                        <td class="txt-bold">12-Ago-2026</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="app-container"></div>

    <div class="notes">
        <h4>‚ö†Ô∏è NOTAS IMPORTANTES DEL PROYECTO</h4>
        <ul>
            <li>Tener presente que en este proyecto las pasarelas peatonales son de 1.2m.</li>
            <li>Para la revisi√≥n del dossier de calidad de cada entrega, nos deben enviar escaneados antes para la revisi√≥n, luego enviar los originales v√≠a a√©rea antes de la fecha zarpe de las estructuras.</li>
            <li>Todo el personal que ingrese Almac√©n, aduanas deben tener sus EPPS completos y su SCTR Actualizados.</li>
            <li>Se tiene que tener los relojes con certificados de calibraci√≥n vigente.</li>
            <li>Comprar nuevo Termohigr√≥metro (temperatura y humedad), con certificados de calibraci√≥n vigente.</li>
            <li>Cuando llegan los 02 medidores de espesores de Galvanizado (1era entrega), se tiene que calibrar y tener certificaci√≥n vigente ac√° en Per√∫.</li>
            <li>Para los Ensayos de materiales (FINALIZADA LA ENTREGA), se tiene que coordinar 1 mes antes con la Empresa Soldex ac√° en Per√∫.</li>
        </ul>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    try {
        // --- RELOJ ---
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('es-PE', { hour12: false });
            const clockEl = document.getElementById('clock-display');
            if(clockEl) clockEl.innerText = timeString;
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateString = now.toLocaleDateString('es-PE', options);
            const dateEl = document.getElementById('date-display');
            if(dateEl) dateEl.innerText = dateString.charAt(0).toUpperCase() + dateString.slice(1);
        }
        setInterval(updateClock, 1000);
        updateClock();

        // --- DATOS (MODIFICADOS PARA UNIFORMIDAD) ---
        const data = [
            {
                t: "1. Documentaci√≥n T√©cnica: dos (02) originales de cada uno",
                plazo: "90 D√≠as Calendario",
                p: [2026, 1, 13], // 13 Feb
                l: [2026, 2, 15], // 15 Mar
                h: "<li>Manual de montaje (Instalaci√≥n) y Lanzamiento</li><li>Manual T√©cnico de Operaci√≥n y Mantenimiento</li><li>Manual T√©cnico (Cat√°logo) de componentes</li><li>Los planos en versi√≥n f√≠sica y digital (AutoCAD editable)</li><li>Video de usos e instalaci√≥n (>10 min, espa√±ol/subtitulado)</li><li>Memoria de C√°lculo.</li>"
            },
            {
                t: "2. 1ra Entrega (Lote 1)",
                plazo: "150 D√≠as Calendario",
                p: [2026, 3, 14], // 14 Abr
                l: [2026, 4, 14], // 14 May
                h: "<li class='check'>08 puentes de 15m una v√≠a s/p DS</li><li class='check'>08 puentes de 21m una v√≠a s/p DS</li><li class='check'>10 puentes de 27m una v√≠a s/p DSR2</li><li class='check'>10 puentes de 39m una v√≠a s/p TSR2</li><li class='check'>01 puentes de 60m una v√≠a s/p DDR2*</li><li class='check'>Narices para 27m, 39m y 60m</li><li class='check'>Tableros y Piezas de reposici√≥n</li><li class='check'>03 juegos kit de herramientas</li><li>Dossier de calidad</li><li>06 torqu√≠metros</li><li>02 medidores espesores (Calibrar en Per√∫)</li><li>Prueba de carga: Puente de una v√≠a (60.96m) sin pasarelas.</li><li>Ensayos de materiales</li>"
            },
            {
                t: "3. 2da Entrega (Lote 2)",
                plazo: "200 D√≠as Calendario",
                p: [2026, 5, 3], // 03 Jun
                l: [2026, 6, 3], // 03 Jul
                h: "<li class='check'>05 puentes de 60m una v√≠a s/p DDR2*5</li><li class='check'>05 puentes de 60m una v√≠a c/p DDR2SH*</li><li class='check'>02 puentes de 15m doble v√≠a s/p DS*</li><li class='check'>04 puentes de 21m doble v√≠a s/p DSR2**</li><li class='check'>Piezas de reposici√≥n</li><li>Dossier de calidad</li><li>Prueba de carga: Puente de doble v√≠a (21.34m) sin pasarelas.</li><li>Ensayos de materiales</li><li>Capacitaci√≥n t√©cnica (Grupo 1)</li>"
            },
            {
                t: "4. 3era Entrega (Lote 3)",
                plazo: "240 D√≠as Calendario",
                p: [2026, 6, 13], // 13 Jul
                l: [2026, 7, 12], // 12 Ago
                h: "<li class='check'>04 puentes de 27m doble v√≠a s/p TSR2*</li><li class='check'>04 puentes de 39m doble v√≠a s/p DDR2*</li><li class='check'>04 puentes de 60m doble v√≠a c/p TDR3SH*</li><li class='check'>Narices doble v√≠a (39m, 60m)</li><li class='check'>Repuestos 10% y Tableros</li><li class='check'>02 juegos kit herramientas</li><li>Dossier de calidad</li><li>04 torqu√≠metros</li><li>Prueba de carga: Puente de doble v√≠a (60.96m) con pasarelas.</li><li>Ensayos de materiales</li><li>Capacitaci√≥n t√©cnica (Grupo 2)</li>"
            }
        ];

        const cont = document.getElementById('app-container');
        const today = new Date(); today.setHours(0,0,0,0);
        const ds = ['Dom','Lun','Mar','Mi√©','Jue','Vie','S√°b'];
        const ms = ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'];

        let html = "";

        data.forEach((item, i) => {
            const dP = new Date(item.p[0], item.p[1], item.p[2]);
            const dL = new Date(item.l[0], item.l[1], item.l[2]);
            
            const difP = Math.ceil((dP - today) / 86400000);
            const difL = Math.ceil((dL - today) / 86400000);

            let cP = 's-ok'; if(difP <= 0) cP = 's-warn';
            let cL = 's-ok'; if(difL <= 30) cL = 's-warn'; if(difL <= 7) cL = 's-dang';

            // FORMATO FECHA CON A√ëO
            const fDate = d => `${ds[d.getDay()]} ${d.getDate()} ${ms[d.getMonth()]} ${d.getFullYear()}`;
            
            const iso = dL.toISOString().slice(0,10).replace(/-/g,"");
            const cal = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(item.t)}&dates=${iso}/${iso}&details=${encodeURIComponent("Plazo Contractual: " + item.plazo)}`;

            html += `
            <div class="card" id="c${i}">
                <div class="card-head" onclick="toggle(${i})">
                    <div class="card-title">${item.t}</div>
                    <div class="plazo-badge">üéØ Plazo Presentaci√≥n: ${item.plazo}</div>
                    <div class="toggle-icon">‚ñº</div>
                    
                    <div class="stats">
                        <div class="stat-box ${cP}">
                            <span class="stat-lbl">üîî INICIO ALERTA DE PLANEAMIENTO<br>(30 D√çAS ANTES)</span>
                            <span class="stat-val">${difP < 0 ? '--' : difP}</span>
                            <span class="stat-desc">D√≠as Cal. Restantes</span>
                            <span class="stat-date">${fDate(dP)}</span>
                        </div>
                        <div class="stat-box ${cL}">
                            <span class="stat-lbl">üö© FECHA L√çMITE DE ENTREGA</span>
                            <span class="stat-val">${difL}</span>
                            <span class="stat-desc">D√≠as Cal. Restantes</span>
                            <span class="stat-date">${fDate(dL)}</span>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <ul>${item.h}</ul>
                    <div style="text-align:center; margin-top:20px;">
                        <a href="${cal}" target="_blank" style="color:#003366; font-weight:bold; text-decoration:none;">üìÖ Agendar en Google Calendar</a>
                    </div>
                </div>
            </div>`;
        });

        if(cont) cont.innerHTML = html;

    } catch (e) {
        document.getElementById('error-display').innerText = "Error: " + e.message;
        document.getElementById('error-display').style.display = 'block';
    }
});

function toggle(id) {
    const el = document.getElementById('c'+id);
    if(el) el.classList.toggle('open');
}

function shareWS() {
    let msg = "*REPORTE EJECUTIVO CONSORCIO HARZONE- KAYSUN - CONTRATO 113*\n\n";
    const today = new Date(); today.setHours(0,0,0,0);
    const items = [
        {n:"Doc. T√©cnica", d:new Date(2026,2,15), p:"90 D√≠as"},
        {n:"1ra Entrega", d:new Date(2026,4,14), p:"150 D√≠as"},
        {n:"2da Entrega", d:new Date(2026,6,3), p:"200 D√≠as"},
        {n:"3ra Entrega", d:new Date(2026,7,12), p:"240 D√≠as"}
    ];
    items.forEach(i => {
        const r = Math.ceil((i.d - today)/86400000);
        const icon = r < 30 ? "‚ö†Ô∏è" : "‚úÖ";
        msg += `${icon} *${i.n}* (Plazo: ${i.p})\nüóìÔ∏è Vence: ${i.d.getDate()}/${i.d.getMonth()+1}/${i.d.getFullYear()}\n‚è≥ Restan: ${r} D√≠as Calendarios\n\n`;
    });
    window.open("https://wa.me/?text=" + encodeURIComponent(msg));
}
</script>
</body>

</html>


